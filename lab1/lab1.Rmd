---
author: "Киселева Александра"
title: "Лабораторная работа 1"
output: html_document
date: "2022-10-31"
---

### Задание 1.

Была написана функция fix_data. Она получает на вход набор данных, у которого в некоторых значениях числовых переменных добавлен пробел между цифрами, убирает этот пробел и возвращает числовым переменным их числовой тип. На выходе получается преобразованный набор данных,
в котором все числовые переменные переведены в числовой тип, при
этом те переменные, которые действительно являются строковыми (остаются нетронутыми.

```{r}
df <- read.csv('lab1_e1.csv')

fix_data <- function(df){
  delete_space <- function(df){
    res <- as.numeric(gsub(" ", "", df))
    if (any(is.na(res))){
      return(df)
    }
    return(res)
  }
  fix_df <- data.frame(sapply(df, delete_space))
}

getwd()
fix_df <- fix_data(df)
print(fix_df)
```


### Задание 2.

Была написана функция get_id. Она получает на вход список, состоящий из семи датафрэймов, содержащих id пациента и temp значение его температуры на каждом из семи приемов у врача, отбирает только тех пациентов, которые посетили все семь приемов у врача, не пропустив ни одного,и считает среднее значение их температуры. На выходе получается новый
датафрэйм, содержащий две переменные: id и mean_temp - среднее значение температуры.

```{r}
load('lab1_e2.RData')

get_id <- function(all_data){
  new_data <- na.omit(Reduce(function(x, y) merge(x, y, by = 'id'), all_data))
  means <- rowMeans(new_data[, -c(1)])
  mean_temp <- data.frame(id = new_data $ id, mean_temp = means)
}

getwd()
data <- get_id(all_data)
print(data)
```

